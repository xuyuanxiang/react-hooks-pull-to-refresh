import { Meta, Props } from '@storybook/addon-docs/blocks';

<Meta title="Basic|å•ç‹¬ä½¿ç”¨" />

# ä½¿ç”¨ç¤ºä¾‹

```typescript jsx
import React, { useState } from 'react';
import { usePullToRefresh } from 'react-hooks-pull-to-refresh';

function MyComponent() {
  const [dataSource, setDataSource] = useState<string[]>([]);

  const onRefresh = async (): Promise<void> => {
    const res = await fetch('/api/to/something');
    if (res.ok) {
      const { data } = await res.json();
      setDataSource(data);
    }
  };

  const options = {}; // æŸ¥çœ‹ä¸‹æ–¹è¡¨æ ¼
  const refresherRef = usePullToRefresh(onRefresh, options);

  return (
    <div ref={refresherRef} style={{ background: '#ffffff' }}>
      {dataSource.map((it, idx) => (
        <p key={`item_${idx}`}>{it}</p>
      ))}
    </div>
  );
}
```

`usePullToRefresh`ç¬¬äºŒä¸ªå‚æ•°:

| å˜é‡å | æè¿° | ç¼ºçœå€¼ |
| :-- | :-- | :-- |
| threshold | å½“ç”¨æˆ·ä¸‹æ‹‰è·ç¦»å¤§äºç­‰äº threshold æ—¶ï¼Œé‡Šæ”¾åä¼šè°ƒç”¨`onRefresh` | 45 |
| throttle | å¤„ç†`touchmove`äº‹ä»¶çš„æ—¶é—´é—´éš”ï¼Œå•ä½ï¼šæ¯«ç§’ã€‚ æ•°å€¼è¶Šå°ï¼Œè¿½è¸ªæ‰‹æŒ‡åœ¨ Y è½´æ–¹å‘ä½ç§»å°±è¶Šç²¾å‡†ï¼Œä½†å¯èƒ½ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ã€‚ | 150 |
| refreshControl | `RefreshControl`ç»„ä»¶ï¼Œç”¨äºæ§åˆ¶`pull-to-refresh`äº¤äº’è¡Œä¸ºä¸­çš„è§†å›¾å‘ˆç°ã€‚ | RefreshControl |

## è‡ªå®šä¹‰ hintã€edgeã€indicator

ä¸‰è€…å…³ç³»ï¼š

- æ»šåŠ¨è§†å›¾å·²ç»åˆ°è¾¾é¡¶éƒ¨åï¼Œç»§ç»­ä¸‹æ‹‰æ˜¾ç¤º hintã€‚
- å·²ç»æ˜¾ç¤º hint åï¼Œç»§ç»­ä¸‹æ‹‰è·ç¦»è¾¾åˆ° threshold å±æ€§æ‰€ä¼ è·ç¦»åæ˜¾ç¤º edgeã€‚
- å·²ç»æ˜¾ç¤º edge åï¼Œç”¨æˆ·é‡Šæ”¾æ‰‹æŒ‡ï¼ˆtouchend)ï¼Œä¼šè°ƒç”¨ onRefreshï¼Œåœ¨ Promise è¿”å›ç»“æœå‰ä¸€ç›´æ˜¾ç¤º indicatorã€‚

```typescript
import React, { useState } from 'react';
import { usePullToRefresh, RefreshControl } from 'react-hooks-pull-to-refresh';

function MyComponent() {
  const [dataSource, setDataSource] = useState<string[]>([]);

  const onRefresh = async (): Promise<void> => {
    const res = await fetch('/api/to/something');
    if (res.ok) {
      const { data } = await res.json();
      setDataSource(data);
    }
  };

  const options = {
    refreshControl: <RefreshControl hint="ğŸ‘‡ä¸‹æ‹‰å¯ä»¥åˆ·æ–°" edge="ğŸ‘†é‡Šæ”¾åå¼€å§‹åˆ·æ–°" indicator="æ­£åœ¨åŠ è½½..." />,
  };
  const refresherRef = usePullToRefresh(onRefresh, options);

  return (
    <div ref={refresherRef} style={{ background: '#ffffff' }}>
      {dataSource.map((it, idx) => (
        <p key={`item_${idx}`}>{it}</p>
      ))}
    </div>
  );
}
```

## è‡ªå®šä¹‰ RefreshControl å®¹å™¨

RefreshControl é»˜è®¤æ˜¯ä¸€ä¸ª`div`å…ƒç´ ï¼Œæ ·å¼ï¼š

```css
background-color: #f6f6f6;
text-align: center;
padding: 32px;
```

è‡ªå®šä¹‰ï¼š

```typescript
import React from 'react';
import { RefreshControlConsumer } from 'react-hooks-pull-to-refresh';

function MyRefreshControl() {
  return (
    <RefreshControlConsumer>
      {({ state }) => {
        if (state === RefreshState.REFRESHING) {
          return (
            <div>
              Loading...
            </div>
          );
        }
        // else if ...
      }}
    </RefreshControlConsumer>
  );
}
```
